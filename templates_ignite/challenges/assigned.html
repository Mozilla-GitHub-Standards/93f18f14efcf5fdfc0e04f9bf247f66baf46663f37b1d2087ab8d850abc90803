{% extends "base.html" %}
{% from "challenges/helpers.html" import created_by with context %}

{% block page_title %}{{ _('All submissions assigned to you') }} |{% endblock %}

{% block page_id %}assigned_submissions{% endblock %}

{% block section_class %}entries{% endblock %}

{% block header %}
<h1 class="shout">Submissions assigned to you</h1>
{% endblock %}

{# No need to display the judge call on this page #}
{% block judgecall %}{% endblock %}

{% block content %}
{% for group_phase in entries|groupby('phase') %}
<h2>{{ group_phase.grouper.name }} phase{% if group_phase.grouper.current_judging_round %}: {{ group_phase.grouper.current_judging_round.name }}{% endif %}</h2>

  {% for group_judging in group_phase.list|groupby('has_judged') %}
    {% if group_judging.grouper %}
    <h3>{% trans %}Judged by you{% endtrans %}</h3>
    <p>
      {% trans count=group_judging.list|length %}
      You have successfully evaluated {{ count }} submission.
      {% pluralize %}
      You have successfully evaluated {{ count }} submissions.
      {% endtrans %}
    </p>
    {% else %}
    <h3>{% trans %}To be Judged{% endtrans %}</h3>
    <p>
      {% trans count=group_judging.list|length %}
      You have {{ count }} submission awaiting evaluation.
      {% pluralize %}
      You have {{ count }} submissions awaiting evaluation.
      {% endtrans %}
    </p>
    {% endif %}
    <ul class="submissions">
      {% for entry in group_judging.list %}
      <li>
        <a href="{{ entry.get_absolute_url() }}">
          {{ entry.title }}
        </a>
      </li>
      {% endfor %}
    </ul>
  {% endfor %}
{% endfor %}

{% if allowance %}
    <section>
      <h2>Green-lit entries for {{ allowance.award.phase.name }} phase {% if allowance.award.phase_round %}. Round {{ allowance.phase_round }}{% endif %}</h2>
      <p>These entries have been green-lit for this phase. Feel free to distribute the and realocate your funding. Entries won't be notified until the admins Freeze the Award.</p>
      <ul>
        <li>Total Funds: ${{ allowance.amount }}</li>
        <li>Allocated Funds: ${{ allowance.amount_used }}</li>
        <li>Free Funds: ${{ allowance.amount_free }}</li>
      </ul>

      <ul>
        {% for object in greenlit_list %}
        <li><a href="{{ object.get_absolute_url() }}">{{ object }}</a></li>
        {% endfor%}
      </ul>
      <h2>Allocated Funding submisssions</h2>
      {% for object in awarded_list %}
      <li><a href="{{ object.submission.get_absolute_url() }}">{{ object.submission }}</a>, awarded ${{ object.amount }}</li>
        {% endfor%}
    </section>
    {% endif %}
{% endblock %}
